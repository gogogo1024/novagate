# Novagate ç³»ç»Ÿæ¶æ„ä¸éƒ¨ç½²

## ğŸ—ï¸ å®Œæ•´ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Client Applications                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                                     â”‚
             â†“                                     â†“
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   Web Browser    â”‚             â”‚  RPC Client SDK  â”‚
     â”‚ (Admin UI: 8888) â”‚             â”‚  (Gateway: 9000) â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                                â”‚
              â†“                                â†“
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                  Docker Network                   â”‚
     â”‚              (172.28.0.0/16)                     â”‚
     â”‚                                                   â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
     â”‚  â”‚         Application Layer                   â”‚ â”‚
     â”‚  â”‚                                             â”‚ â”‚
     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
     â”‚  â”‚  â”‚    Admin     â”‚    â”‚    Gateway       â”‚  â”‚ â”‚
     â”‚  â”‚  â”‚  (Go HTTP)   â”‚    â”‚  (Go RPC)        â”‚  â”‚ â”‚
     â”‚  â”‚  â”‚   Port 8888  â”‚    â”‚  Port 9000       â”‚  â”‚ â”‚
     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
     â”‚  â”‚         â”‚                     â”‚            â”‚ â”‚
     â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â”‚
     â”‚  â”‚                       â”‚                    â”‚ â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
     â”‚                          â”‚                      â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
     â”‚  â”‚    Storage Layer     â”‚                 â”‚   â”‚
     â”‚  â”‚                      â”‚                 â”‚   â”‚
     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚   â”‚
     â”‚  â”‚  â”‚     Redis      â”‚â”€â”€â”¼â”€â”€â”‚ (ACL/Perm) â”‚â”‚   â”‚
     â”‚  â”‚  â”‚   6379         â”‚  â”‚  â”‚            â”‚â”‚   â”‚
     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚   â”‚
     â”‚  â”‚                      â”‚                â”‚   â”‚
     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                â”‚   â”‚
     â”‚  â”‚  â”‚  PostgreSQL    â”‚  â”‚                â”‚   â”‚
     â”‚  â”‚  â”‚  5432          â”‚  â”‚                â”‚   â”‚
     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                â”‚   â”‚
     â”‚  â”‚                      â”‚                â”‚   â”‚
     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                â”‚   â”‚
     â”‚  â”‚  â”‚    MySQL       â”‚  â”‚                â”‚   â”‚
     â”‚  â”‚  â”‚    3306        â”‚  â”‚                â”‚   â”‚
     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                â”‚   â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
     â”‚                         â”‚                     â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
     â”‚  â”‚  Messaging & Search  â”‚                â”‚   â”‚
     â”‚  â”‚  (Profile: kafka)    â”‚                â”‚   â”‚
     â”‚  â”‚                      â”‚                â”‚   â”‚
     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
     â”‚  â”‚  â”‚   Kafka        â”‚â”€â”€â”¼â”€â”€â”‚ 9092     â”‚ â”‚   â”‚
     â”‚  â”‚  â”‚ Zookeeper      â”‚  â”‚  â”‚ (Events) â”‚ â”‚   â”‚
     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
     â”‚  â”‚                      â”‚                â”‚   â”‚
     â”‚  â”‚  (Profile: milvus)   â”‚                â”‚   â”‚
     â”‚  â”‚                      â”‚                â”‚   â”‚
     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
     â”‚  â”‚  â”‚    Milvus      â”‚â”€â”€â”¼â”€â”€â”‚ 19530    â”‚ â”‚   â”‚
     â”‚  â”‚  â”‚    (etcd)      â”‚  â”‚  â”‚ (Vector) â”‚ â”‚   â”‚
     â”‚  â”‚  â”‚    (MinIO)     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                â”‚   â”‚
     â”‚  â”‚                      â”‚                â”‚   â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
     â”‚                         â”‚                     â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚                            â”‚
                 â†“                            â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Management UI   â”‚      â”‚  Development UI  â”‚
        â”‚  (localhost:    â”‚      â”‚                 â”‚
        â”‚   8888)         â”‚      â”‚  Docker Compose â”‚
        â”‚                â”‚      â”‚  Health Checks  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ æ ¸å¿ƒæœåŠ¡è¯¦è§£

### 1. åº”ç”¨å±‚

#### Admin ç®¡ç†åå°ï¼ˆGo HTTP æœåŠ¡ï¼‰
- **ç«¯å£**ï¼š8888
- **åŠŸèƒ½**ï¼š
  - Web UI ç”¨æˆ·ç•Œé¢ï¼ˆHTML/CSS/JavaScriptï¼‰
  - RESTful API æœåŠ¡ï¼ˆ9 ä¸ªç«¯ç‚¹ï¼‰
  - æƒé™ç®¡ç†ã€æ–‡æ¡£ç®¡ç†ã€å®¡è®¡æ—¥å¿—
- **è¿æ¥**ï¼šRedis
- **å¥åº·æ£€æŸ¥**ï¼š`GET /api/users`

#### Gateway ç½‘å…³ï¼ˆGo RPC æœåŠ¡ï¼‰
- **ç«¯å£**ï¼š9000
- **åŠŸèƒ½**ï¼š
  - TCP RPC å…¥å£
  - å‘½ä»¤è·¯ç”±ä¸è½¬å‘
  - è¿æ¥ç®¡ç†ä¸èµ„æºæ§åˆ¶
- **è¿æ¥**ï¼šRedisï¼ˆæƒé™æŸ¥è¯¢ï¼‰
- **å¥åº·æ£€æŸ¥**ï¼šTCP ç«¯å£è¿æ¥

### 2. å­˜å‚¨å±‚

#### Redisï¼ˆå¿…éœ€ï¼‰
- **ç”¨é€”**ï¼šæƒé™å­˜å‚¨ã€ç¼“å­˜ã€ä¼šè¯ç®¡ç†
- **ç«¯å£**ï¼š6379
- **æ•°æ®ç»“æ„**ï¼š
  ```
  user:${uid}              â†’ Hash (user info)
  doc:${doc_id}            â†’ Hash (document meta)
  acl:${tenant}:${uid}     â†’ Set (authorized docs)
  audit_log:*              â†’ String (timestamp log)
  ```
- **æŒä¹…åŒ–**ï¼šRDB/AOFï¼ˆDocker å·æŒä¹…åŒ–ï¼‰

#### PostgreSQLï¼ˆå¯é€‰ï¼‰
- **ç”¨é€”**ï¼šå…³ç³»å‹æ•°æ®å­˜å‚¨
- **ç«¯å£**ï¼š5432
- **æ•°æ®åº“**ï¼šnovagate

#### MySQLï¼ˆå¯é€‰ï¼‰
- **ç”¨é€”**ï¼šå…³ç³»å‹æ•°æ®å­˜å‚¨
- **ç«¯å£**ï¼š3306
- **æ•°æ®åº“**ï¼šnovagate

### 3. æ¶ˆæ¯ä¸æœç´¢å±‚ï¼ˆ`--profile kafka`ï¼‰

#### Kafka + Zookeeper
- **ç”¨é€”**ï¼šäº‹ä»¶é˜Ÿåˆ—ã€æ—¥å¿—æµ
- **ç«¯å£**ï¼š9092ï¼ˆKafkaï¼‰
- **è¯é¢˜**ï¼š
  - `gateway-events` - ç½‘å…³äº‹ä»¶
  - `acl-audit` - æƒé™å®¡è®¡æ—¥å¿—
  - `vector-updates` - å‘é‡æ›´æ–°
- **Kafka UI**ï¼šhttp://localhost:8080

### 4. å‘é‡æ•°æ®åº“ï¼ˆ`--profile milvus`ï¼‰

#### Milvusï¼ˆå‘é‡æ•°æ®åº“ï¼‰
- **ç”¨é€”**ï¼šRAG æ£€ç´¢ã€å‘é‡ç›¸ä¼¼åº¦æœç´¢
- **ç«¯å£**ï¼š19530
- **ä¾èµ–**ï¼š
  - etcdï¼ˆå…ƒæ•°æ®å­˜å‚¨ï¼‰
  - MinIOï¼ˆå¯¹è±¡å­˜å‚¨ï¼‰
- **Milvus Attu UI**ï¼šhttp://localhost:8000
- **MinIO Console**ï¼šhttp://localhost:9001

### 5. ç®¡ç†å·¥å…·

#### Redis Insightsï¼ˆå¯é€‰ï¼‰
- **ç”¨é€”**ï¼šRedis å¯è§†åŒ–ç®¡ç†
- **ç«¯å£**ï¼š5540
- **è®¿é—®**ï¼šhttp://localhost:5540

#### Kafka UIï¼ˆä»… `--profile kafka`ï¼‰
- **ç”¨é€”**ï¼šKafka å¯è§†åŒ–ç®¡ç†
- **ç«¯å£**ï¼š8080
- **è®¿é—®**ï¼šhttp://localhost:8080

#### Milvus Attuï¼ˆä»… `--profile milvus`ï¼‰
- **ç”¨é€”**ï¼šMilvus å¯è§†åŒ–ç®¡ç†
- **ç«¯å£**ï¼š8000
- **è®¿é—®**ï¼šhttp://localhost:8000

---

## ğŸš€ ä¸‰ç§éƒ¨ç½²æ¨¡å¼

### æ¨¡å¼ 1ï¼šå¿«é€Ÿå¯åŠ¨ï¼ˆæœ€å°åŒ–ï¼‰

```bash
docker-compose up -d
```

**åŒ…å«æœåŠ¡**ï¼š
- Redis
- Adminï¼ˆWeb UIï¼‰
- Gatewayï¼ˆRPCï¼‰
- ç®¡ç†å·¥å…·ï¼šRedis Insights

**é€‚ç”¨åœºæ™¯**ï¼š
- âœ… æœ¬åœ°å¼€å‘
- âœ… åŠŸèƒ½æ¼”ç¤º
- âœ… é›†æˆæµ‹è¯•

**èµ„æºéœ€æ±‚**ï¼š
- å†…å­˜ï¼š~500MB
- ç£ç›˜ï¼š~1GB

---

### æ¨¡å¼ 2ï¼šå®Œæ•´å¯åŠ¨ï¼ˆåŠ å…¥æ¶ˆæ¯é˜Ÿåˆ—ï¼‰

```bash
docker-compose --profile kafka up -d
```

**æ–°å¢æœåŠ¡**ï¼š
- Kafka
- Zookeeper
- Kafka UI

**é€‚ç”¨åœºæ™¯**ï¼š
- âœ… äº‹ä»¶é©±åŠ¨æ¶æ„
- âœ… æ¶ˆæ¯é˜Ÿåˆ—æµ‹è¯•
- âœ… å®¡è®¡æ—¥å¿—ç³»ç»Ÿ
- âœ… å¤šæœåŠ¡è§£è€¦

**èµ„æºéœ€æ±‚**ï¼š
- å†…å­˜ï¼š~1.5GB
- ç£ç›˜ï¼š~3GB

---

### æ¨¡å¼ 3ï¼šå…¨åŠŸèƒ½å¯åŠ¨ï¼ˆåŠ å…¥å‘é‡æ•°æ®åº“ï¼‰

```bash
docker-compose --profile kafka --profile milvus up -d
```

**æ–°å¢æœåŠ¡**ï¼š
- Milvus
- etcd
- MinIO
- Milvus Attu
- Kafka + Zookeeper

**é€‚ç”¨åœºæ™¯**ï¼š
- âœ… RAG ç³»ç»Ÿæ¼”ç¤º
- âœ… å‘é‡æ£€ç´¢åŠŸèƒ½
- âœ… AI åº”ç”¨é›†æˆ
- âœ… å®Œæ•´ç³»ç»Ÿæ¼”ç¤º

**èµ„æºéœ€æ±‚**ï¼š
- å†…å­˜ï¼š~3GB
- ç£ç›˜ï¼š~5GB

---

## ğŸ“‹ åˆå§‹åŒ–æ•°æ®

### é»˜è®¤ç”¨æˆ·

```
user-001: Alice (alice@example.com)
user-002: Bob (bob@example.com)
```

### é»˜è®¤æ–‡æ¡£

```
doc-001: Python æœ€ä½³å®è·µ
doc-002: Go å¹¶å‘ç¼–ç¨‹
doc-003: JavaScript æ¡†æ¶å¯¹æ¯”
```

### é»˜è®¤æƒé™

```
Aliceï¼šå¯è®¿é—® doc-001, doc-002
Bobï¼šå¯è®¿é—® doc-001
```

> åˆå§‹åŒ–æ•°æ®å­˜å‚¨åœ¨ Redisï¼Œé€šè¿‡ `scripts/init-redis.sh` è‡ªåŠ¨é…ç½®ã€‚

---

## ğŸ”— æœåŠ¡é—´é€šä¿¡

### é€šä¿¡æ‹“æ‰‘

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Admin æœåŠ¡                          â”‚
â”‚  â”œâ”€ Web UI (HTML/CSS/JS)                            â”‚
â”‚  â””â”€ API Server (localhost:8888)                     â”‚
â”‚        â”‚                                             â”‚
â”‚        â”œâ”€â”€â†’ Redis (æƒé™æŸ¥è¯¢ã€æ•°æ®å­˜å‚¨)              â”‚
â”‚        â””â”€â”€â†’ å®¡è®¡æ—¥å¿—                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Gateway ç½‘å…³æœåŠ¡                        â”‚
â”‚  (TCP RPC, localhost:9000)                          â”‚
â”‚        â”‚                                             â”‚
â”‚        â”œâ”€â”€â†’ Redis (æƒé™éªŒè¯)                        â”‚
â”‚        â”œâ”€â”€â†’ Kafka (äº‹ä»¶å‘å¸ƒ) â† optional             â”‚
â”‚        â””â”€â”€â†’ ä¸šåŠ¡ Handler è½¬å‘                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        åç«¯ä¸šåŠ¡é€»è¾‘ï¼ˆå¯é€‰é›†æˆï¼‰                      â”‚
â”‚  â”œâ”€ PostgreSQL (æ•°æ®åº“)                             â”‚
â”‚  â”œâ”€ MySQL (æ•°æ®åº“)                                  â”‚
â”‚  â”œâ”€ Milvus (å‘é‡æ£€ç´¢) â† optional                    â”‚
â”‚  â””â”€ Kafka (æ¶ˆè´¹äº‹ä»¶) â† optional                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åè®®è§„èŒƒ

æ‰€æœ‰ç½‘ç»œé€šä¿¡éµå¾ª [docs/protocol.md](docs/protocol.md) å®šä¹‰ï¼š

- **Frame**ï¼š8 å­—èŠ‚ Header + Variable Body
- **Message**ï¼šCommand + RequestID + Payload
- **ç¼–ç **ï¼šå¤§ç«¯å­—èŠ‚åº
- **å‹ç¼©**ï¼šæ”¯æŒ gzip

---

## ğŸ”’ æƒé™ä¸å®‰å…¨

### ACL æ¨¡å‹

- **ç²’åº¦**ï¼šç”¨æˆ· Ã— æ–‡æ¡£
- **å­˜å‚¨**ï¼šRedis Sets (`acl:tenant:user` â†’ doc IDs)
- **éªŒè¯**ï¼šåœ¨ Gateway å’Œ Admin ç«¯è¿›è¡Œæƒé™æ£€æŸ¥

### æƒé™æµç¨‹

```
å®¢æˆ·ç«¯è¯·æ±‚ â†’ Gateway â†’ æŸ¥è¯¢ Redis ACL â†’ éªŒè¯æƒé™ â†’ è½¬å‘å¤„ç†
```

---

## ğŸ“Š ç›‘æ§ä¸è°ƒè¯•

### å¥åº·æ£€æŸ¥

```bash
# æ‰€æœ‰æœåŠ¡
docker-compose ps

# å•ä¸ªæœåŠ¡æ—¥å¿—
docker-compose logs -f admin
docker-compose logs -f gateway
docker-compose logs -f redis
```

### API éªŒè¯

```bash
# ç”¨æˆ·åˆ—è¡¨
curl http://localhost:8888/api/users

# æ–‡æ¡£åˆ—è¡¨
curl http://localhost:8888/api/documents

# æƒé™åˆ—è¡¨
curl http://localhost:8888/api/permissions
```

### æ•°æ®éªŒè¯

```bash
# Redis æ•°æ®
docker-compose exec redis redis-cli
  > HGETALL user:user-001
  > SMEMBERS acl:tenant-001:user-001
  > KEYS *
```

---

## ğŸš¦ å¯åŠ¨é¡ºåºä¸ä¾èµ–

```
å¯åŠ¨ Docker Compose:
â”‚
â”œâ”€ Redis (åŸºç¡€å­˜å‚¨)
â”‚   â”œâ”€ Admin (ä¾èµ– Redis å¥åº·)
â”‚   â”‚   â””â”€ Web UI Ready
â”‚   â””â”€ Gateway (ä¾èµ– Redis å¥åº·)
â”‚       â””â”€ RPC Ready
â”‚
â”œâ”€ PostgreSQL (å¯é€‰ï¼Œç‹¬ç«‹)
â”œâ”€ MySQL (å¯é€‰ï¼Œç‹¬ç«‹)
â”‚
â”œâ”€ Zookeeper (profile: kafka)
â”‚   â””â”€ Kafka (ä¾èµ– Zookeeper)
â”‚       â””â”€ Kafka UI (å¯è§†åŒ–)
â”‚
â””â”€ etcd + MinIO (profile: milvus)
    â””â”€ Milvus (ä¾èµ– etcd + MinIO)
        â””â”€ Milvus Attu (å¯è§†åŒ–)
```

---

## ğŸ”„ å®Œæ•´å·¥ä½œæµç¤ºä¾‹

### 1. å¯åŠ¨ç³»ç»Ÿ

```bash
docker-compose --profile kafka --profile milvus up -d
```

### 2. ç­‰å¾…æœåŠ¡å°±ç»ª

```bash
docker-compose ps
# æ£€æŸ¥æ‰€æœ‰æœåŠ¡æ˜¾ç¤º "healthy"
```

### 3. ç®¡ç†ç”¨æˆ·å’Œæƒé™

```bash
curl http://localhost:8888/api/users
curl -X POST http://localhost:8888/api/users/create \
  -H "Content-Type: application/json" \
  -d '{"id":"user-003","name":"Charlie"}'
```

### 4. éªŒè¯æƒé™

```bash
docker-compose exec redis redis-cli
  > SMEMBERS acl:tenant-001:user-003
```

### 5. æ¼”ç¤º RAG åŠŸèƒ½

```bash
docker-compose exec milvus python /scripts/rag-demo.py
```

### 6. ç›‘æ§ç³»ç»Ÿ

```bash
docker-compose logs -f admin gateway
```

### 7. åœæ­¢å¹¶æ¸…ç†

```bash
docker-compose down -v
```

---

## ğŸ“š å‚è€ƒé“¾æ¥

- [å¿«é€Ÿå¼€å§‹](QUICK_START.md)
- [Docker Compose å®Œæ•´æŒ‡å—](docs/docker-compose-guide.md)
- [å‘½ä»¤é€ŸæŸ¥è¡¨](docs/docker-compose-cheatsheet.md)
- [ç®¡ç†åå°æŒ‡å—](docs/admin-guide.md)
- [åè®®æ–‡æ¡£](docs/protocol.md)
- [ACL æ–‡æ¡£](docs/acl-rag-contract.md)

---

**ç‰ˆæœ¬**ï¼šv1.0 | **æœ€åæ›´æ–°**ï¼š2025å¹´1æœˆ
